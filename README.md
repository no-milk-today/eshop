# Интернет магазин

Web-приложение на Spring Boot, представляющее витрину товаров, которые пользователь может добавить в корзину и купить.

## Технологии

- **Java 21**, **Spring Boot 3.4.2**
- **Gradle** – сборка проекта
- **Thymeleaf** – серверный шаблонизатор HTML с поддержкой JavaScript
- **Spring Data JPA** – работа с базой данных
- **PostgreSQL 16** – база данных
- **Liquibase** – миграции базы данных
- **JUnit 5** – модульные и интеграционные тесты
- **Docker**
- **Testcontainers** – тестирование с использованием контейнеров

## Сборка и запуск

1. **Поднять docker compose:**

   ```bash
   export PG_USERNAME=yourDesiredUsername
   export PG_PASSWORD=yourDesiredPassword
   docker compose up -d
   ```

2. **Запуск приложения:**

Прокинуть env переменные `PG_USERNAME=значение` и `PG_PASSWORD=значение`.

```bash
$env:PG_USERNAME="значение"; $env:PG_PASSWORD="значение"; 
gradlew build;
java -jar build\libs\eshop-1.0.1.jar
```
- **начальные данные** находятся в файле `resources/db/sql/init-data.sql`.
- Этот скрипт нужно запустить после успешного старта приложения.

## Структура шаблонов

Папка `templates` находится в `src/main/resources`.

- **main.html** – главная витрина магазина, отображающая список всех товаров
- **item.html** – страница с описание товара (карточка товара)
- **cart.html** – страница с корзиной товаров
- **orders-list.html** – страница со списком всех заказов
- **order.html** – страница с деталями заказа

## Тестирование

- **Запуск тестов с использованием testcontainers:**

  ```bash
  ./gradlew test
  ```

  Тесты включают модульные и интеграционные, охватывающие основные компоненты приложения.

## Эндпоинты приложения

- **GET \"/\"**  
  Редирект на \"/main/items\"

- **GET \"/main/items\"**  
  Вывод списка всех товаров плиткой на главной странице

- **POST \"/main/items/{id}\"**  
  Изменение количества товара в корзине

- **GET \"/cart/items\"**  
  Вывод содержимого корзины

- **POST \"/cart/items/{id}\"**  
  Изменение количества товара в корзине

- **GET \"/items/{id}\"**  
  Карточка товара

- **POST \"/items/{id}\"**  
  Изменение количества товара в корзине

- **POST \"/buy\"**  
  Оформление покупки – выполняет покупку товаров в корзине и очищает ее

- **GET \"/orders\"**  
  Вывод списка заказов

- **GET \"/orders/{id}\"**  
  Карточка заказа